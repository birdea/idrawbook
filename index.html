<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/svg+xml" href="/vite.svg" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>iDrawBook</title>
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <script src="https://apis.google.com/js/api.js" async defer></script>
</head>

<body>
  <header>
    <div class="header-left">
      <div class="logo">iDrawBook</div>
    </div>
    <div class="header-right">
      <span class="bd-text">{BD} creative </span>
      <span class="version-display"></span>
      <!-- Future extension -->
    </div>
  </header>

  <!-- Menu Bar -->
  <div class="menu-bar">
    <button class="menu-icon-btn" id="menu-header-toggle-left"></button>
    <div class="v-separator"></div>

    <div class="menu-item" data-menu="file">
      <span>BOOK</span>
      <div class="menu-dropdown">
        <button id="menu-new">New Book</button>
        <button id="menu-open">Open Book <span class="shortcut text-todo">[TODO]</span></button>
        <button id="menu-close">Close Book <span class="shortcut text-todo">[TODO]</span></button>
        <button id="menu-delete">Delete Book </button>
        <button id="menu-save">Save Book</button>
        <button id="menu-recent">Recent Books <span class="shortcut text-todo">[TODO]</span></button>
        <div class="menu-separator"></div>
        <button id="menu-settings">Settings</button>
        <div class="menu-separator"></div>
        <button id="menu-google-login">
          <span id="menu-google-icon" class="icon-left"></span>
          <span>Sign in Google</span>
        </button>
        <div id="menu-user-info" class="hidden">
          <div class="user-info-display">
            <img id="menu-user-avatar" src="" alt="Avatar">
            <span id="menu-user-name"></span>
          </div>
          <button id="menu-google-logout">Sign out</button>
        </div>
      </div>
    </div>
    <div class="menu-item" data-menu="edit">
      <span>EDIT</span>
      <div class="menu-dropdown">
        <button id="menu-undo">Undo <span class="shortcut">Ctrl+Z</span></button>
        <button id="menu-redo">Redo <span class="shortcut">Ctrl+Shift+Z</span></button>
        <div class="menu-separator"></div>
        <button id="menu-cut">Cut <span class="shortcut text-todo">[TODO]</span></button>
        <button id="menu-copy">Copy <span class="shortcut text-todo">[TODO]</span></button>
        <button id="menu-paste">Paste <span class="shortcut text-todo">[TODO]</span></button>
        <button id="menu-delete-edit">Delete <span class="shortcut text-todo">[TODO]</span></button>
        <div class="menu-separator"></div>
        <button id="menu-select">Select <span class="shortcut text-todo">[TODO]</span></button>
        <button id="menu-select-all">Select All <span class="shortcut text-todo">[TODO]</span></button>
      </div>
    </div>
    <div class="menu-item" data-menu="view">
      <span>VIEW</span>
      <div class="menu-dropdown">
        <button id="menu-toggle-left">Hide Toolbar (L) <span class="shortcut">Ctrl+L</span></button>
        <button id="menu-toggle-right">Hide Toolbar (R) <span class="shortcut">Ctrl+R</span></button>
      </div>
    </div>
    <div class="menu-item" data-menu="help">
      <span>HELP</span>
      <div class="menu-dropdown">
        <button id="menu-search">Search...</button>
        <div class="menu-separator"></div>
        <button id="menu-about">About iDrawBook</button>
        <button id="menu-contacts">Contacts</button>
      </div>
    </div>

    <div class="menu-spacer"></div>
    <div class="v-separator"></div>
    <button class="menu-icon-btn" id="menu-header-toggle-right"></button>
  </div>

  <main class="main-container">
    <aside class="tool-panel">
      <button class="tool-btn" id="add-page-btn" data-tooltip="Add Page">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="12" y1="8.5" x2="12" y2="15.5" stroke="#1d1d1f"></line>
          <line x1="8.5" y1="12" x2="15.5" y2="12" stroke="#1d1d1f"></line>
        </svg>
      </button>
      <div class="h-separator"></div>
      <div class="global-tool-indicator" id="global-tool-indicator">
        <div class="tool-indicator-color"></div>
        <div class="tool-indicator-size"></div>
      </div>
      <div class="h-separator"></div>
      <div class="tool-group" id="drawing-tools">
        <button class="tool-btn active" id="tool-pencil" data-tool="pencil" data-tooltip="Pencil (Ctrl+P)"></button>
        <button class="tool-btn" id="tool-brush" data-tool="brush" data-tooltip="Brush (Ctrl+B)"></button>
        <button class="tool-btn" id="tool-pen" data-tool="pen" data-tooltip="Pen"></button>
        <button class="tool-btn" id="tool-fill" data-tool="fill" data-tooltip="Fill Color (Ctrl+F)"></button>
      </div>
      <div class="h-separator"></div>
      <div class="tool-group">
        <button class="tool-btn" id="tool-eraser" data-tool="eraser" data-tooltip="Eraser (Ctrl+E)"></button>
      </div>
      <div class="h-separator"></div>
      <div class="tool-group" id="shape-tools">
        <button class="tool-btn" id="tool-line" data-tool="line" data-tooltip="Line"></button>
        <button class="tool-btn" id="tool-rect" data-tool="rect" data-tooltip="Rectangle"></button>
        <button class="tool-btn" id="tool-circle" data-tool="circle" data-tooltip="Circle"></button>
      </div>
      <div class="h-separator"></div>
      <div class="tool-group">
        <button class="tool-btn" id="tool-text" data-tool="text" data-tooltip="Text (Ctrl+T)"></button>
      </div>
      <div class="h-separator"></div>
      <div class="tool-group">
        <button class="tool-btn" id="tool-hand" data-tool="hand" data-tooltip="Hand (Ctrl+H)"></button>
      </div>
    </aside>

    <section class="canvas-wrapper" id="canvas-container">
      <canvas id="main-canvas"></canvas>

      <div class="history-controls">
        <button id="main-undo-btn" class="icon-btn" data-tooltip="Undo (Ctrl+Z)"></button>
        <div class="v-separator"></div>
        <button id="main-redo-btn" class="icon-btn" data-tooltip="Redo (Ctrl+Shift+Z)"></button>
      </div>

      <div class="zoom-controls">
        <div id="zoom-level">100%</div>
        <div class="v-separator"></div>
        <button id="zoom-out-btn" class="zoom-btn" data-tooltip="Zoom Out"></button>
        <div class="v-separator"></div>
        <button id="zoom-in-btn" class="zoom-btn" data-tooltip="Zoom In"></button>
      </div>
    </section>

    <aside class="properties-panel">
      <div class="prop-section collapsible" id="section-stroke">
        <div class="prop-header">
          <h3>Stroke</h3>
          <span class="chevron-icon" id="icon-chevron-stroke"></span>
        </div>
        <div class="prop-content">
          <div class="prop-control">
            <label>Size</label>
            <input type="range" id="stroke-size" min="1" max="50" value="5">
          </div>
          <div class="prop-control">
            <label>Opacity</label>
            <input type="range" id="stroke-opacity" min="1" max="100" value="100">
          </div>
          <div class="prop-control">
            <label>Hardness</label>
            <input type="range" id="stroke-hardness" min="0" max="100" value="100">
          </div>
          <div class="prop-control">
            <label>Pressure Sensitivity</label>
            <input type="range" id="stroke-pressure" min="0" max="100" value="50">
          </div>
        </div>
      </div>

      <div class="prop-section collapsible" id="section-color">
        <div class="prop-header">
          <h3>Color</h3>
          <span class="chevron-icon" id="icon-chevron-color"></span>
        </div>
        <div class="prop-content">
          <div class="color-grid" id="color-grid">
            <!-- Swatches injected dynamically -->
          </div>
          <div class="custom-color-picker">
            <input type="color" id="color-picker" value="#000000">
          </div>
        </div>
      </div>

      <div class="prop-section collapsible" id="section-canvas">
        <div class="prop-header">
          <h3>Canvas</h3>
          <span class="chevron-icon" id="icon-chevron-canvas"></span>
        </div>
        <div class="prop-content">
          <div class="prop-control">
            <span id="canvas-info" style="font-size: 14px; font-weight: 500; color: var(--apple-text);">Page (1/1) :
              1024 x 1024 px</span>
          </div>
        </div>
      </div>

      <div class="prop-section collapsible" id="section-preview">
        <div class="prop-header">
          <h3>Preview</h3>
          <span class="prop-header-arrow" id="icon-arrow-preview"></span>
        </div>
        <div class="prop-content">
          <div class="preview-list" id="preview-list">
          </div>
        </div>
      </div>
    </aside>
  </main>

  <!-- Save Modal -->
  <div id="save-modal" class="modal-overlay hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Save File</h3>
        <button id="save-modal-close" class="close-btn">&times;</button>
      </div>
      <div class="modal-body">

        <!-- File Name -->
        <div class="input-group">
          <label>File Name</label>
          <div class="filename-input-wrapper">
            <input type="text" id="save-filename" value="Untitled" placeholder="Enter filename">
            <span id="save-file-ext" class="extension-label">.png</span>
          </div>
        </div>

        <!-- Format -->
        <div class="input-group">
          <label>Format</label>
          <div class="format-options">
            <label class="radio-label">
              <input type="radio" name="save-format" value="png" checked> PNG
            </label>
            <label class="radio-label">
              <input type="radio" name="save-format" value="jpeg"> JPG
            </label>
            <label class="radio-label">
              <input type="radio" name="save-format" value="pdf"> PDF
            </label>
          </div>
        </div>

        <!-- Quality Slider (Conditional) -->
        <div class="input-group hidden" id="save-quality-group">
          <div class="flex-between">
            <label>Quality</label>
            <span id="quality-val-display">80%</span>
          </div>
          <input type="range" id="save-quality" min="10" max="100" value="80">
        </div>

        <div class="modal-separator"></div>

        <!-- Save Actions -->
        <div class="save-actions-grid">
          <!-- Local Save -->
          <div class="action-block">
            <h4>Local Storage</h4>
            <button id="btn-save-local" class="btn-primary full-width">
              Download
            </button>
          </div>

          <!-- Drive Save -->
          <div class="action-block">
            <div class="flex-between">
              <h4>Google Drive</h4>
              <span id="drive-status" class="status-badge hidden">Logged In</span>
            </div>
            <!-- Folder Selection -->
            <div id="drive-folder-ui" class="folder-select-mini hidden">
              <span class="folder-icon">ðŸ“‚</span>
              <span id="selected-folder-name" class="folder-name">My Drive</span>
              <button id="change-folder-btn" class="btn-link">Change</button>
            </div>
            <button id="btn-save-drive" class="btn-secondary full-width" disabled>
              Save to Drive
            </button>
          </div>
        </div>

      </div>
    </div>
  </div>

  <!-- Mobile Bottom Bar (Visible only on mobile) -->
  <div class="mobile-bottom-bar hidden-desktop" id="mobile-bottom-bar">
    <!-- Buttons will be injected dynamically -->
  </div>

  <!-- Mobile Generic Section Modal -->
  <div id="mobile-generic-modal" class="modal-overlay hidden">
    <div class="modal-content bottom-sheet">
      <div class="modal-header">
        <h3 id="mobile-modal-title">Settings</h3>
        <button id="mobile-modal-close" class="close-btn">&times;</button>
      </div>
      <div class="modal-body" id="mobile-modal-body">
        <!-- Section content will be moved here dynamically -->
      </div>
    </div>
  </div>

  <!-- Settings Modal -->
  <div id="settings-modal" class="modal-overlay hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Settings</h3>
        <button id="settings-close" class="close-btn">&times;</button>
      </div>
      <div class="modal-body">
        <div class="input-group">
          <label>History Limit (Undo/Redo)</label>
          <input type="number" id="history-limit" value="100" min="10" max="500">
          <span class="hint">Max number of actions to remember.</span>
        </div>

        <div class="input-group">
          <label>Total Colors in Palette</label>
          <input type="number" id="color-count" value="20" min="1" max="100">
        </div>
        <div class="input-group">
          <label>Max Colors per Row</label>
          <input type="number" id="color-columns" value="10" min="1" max="20">
        </div>
      </div>
      <div class="modal-footer" style="justify-content: space-between;">
        <span class="version-info"></span>
        <div style="display: flex; gap: 10px;">
          <button id="settings-cancel-btn" class="btn-text">Cancel</button>
          <button id="settings-save-btn" class="btn-primary">Save Changes</button>
        </div>
      </div>
    </div>
  </div>

  <!-- New Book Modal -->
  <div id="new-book-modal" class="modal-overlay hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h3>New Book</h3>
        <button id="new-book-close" class="close-btn">&times;</button>
      </div>
      <div class="modal-body">
        <div class="input-group">
          <label>Width (px)</label>
          <input type="number" id="new-book-width" value="1024" min="100" max="10000">
        </div>
        <div class="input-group">
          <label>Height (px)</label>
          <input type="number" id="new-book-height" value="1024" min="100" max="10000">
        </div>
      </div>
      <div class="modal-footer">
        <button id="new-book-cancel-btn" class="btn-text">Cancel</button>
        <button id="new-book-create-btn" class="btn-primary">Create</button>
      </div>
    </div>
  </div>

  <!-- New Page Modal -->
  <div id="new-page-modal" class="modal-overlay hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h3>New Page</h3>
        <button id="new-page-close" class="close-btn">&times;</button>
      </div>
      <div class="modal-body">
        <div class="input-group">
          <label>Width (px)</label>
          <input type="number" id="new-page-width" value="1024" min="100" max="5000">
        </div>
        <div class="input-group">
          <label>Height (px)</label>
          <input type="number" id="new-page-height" value="1024" min="100" max="5000">
        </div>
      </div>
      <div class="modal-footer">
        <button id="new-page-cancel-btn" class="btn-text">Cancel</button>
        <button id="new-page-create-btn" class="btn-primary">Add Page</button>
      </div>
    </div>
  </div>

  <div id="toast-container" class="toast-container"></div>

  <script type="module" src="/src/main.ts"></script>
</body>

</html>